<div class="content-shadow bg-white mb-5" not-authorized [notAuthorized]="isNotAuthorized">
  <h2 class="size-body title-with-btn plr-4 ptb-4">
    <span class="page-title">{{ 'tr_users' | translate }}</span>
    <div class="btn-group">
      <button class="s-btn btn-primary" (click)="createOrEditUser(false)">
        {{ 'tr_add_user' | translate }}
      </button>
      <button class="s-btn btn-secondary size-body" (click)="isFilterOpen = !isFilterOpen">
        <i class="fa fa-filter text-primary"></i>
      </button>
    </div>
  </h2>

  <div class="filters-card bg-secondary plr-4 ptb-2 mb-7" *ngIf="isFilterOpen">
    <div class="row">
      <div class="col-md-3">
        <div class="form-group mb-0">
          <label>{{ 'tr_name' | translate }}/{{ 'tr_email' | translate }}</label>
          <div class="input-with-icon bg-white width-100">
            <input
              class="s-control"
              placeholder="{{ 'tr_search' | translate }}"
              [(ngModel)]="nameSearchTerm"
              (keyup)="filterUsers($event, 'search')"
            />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="plr-4 mt-4" *ngIf="!usersLoading">
    <div class="table-container" *ngIf="usersList.length > 0">
      <table class="s-table table users-list layout-fixed">
        <thead>
          <tr>
            <th>ID</th>
            <th>{{ 'tr_name' | translate }}</th>
            <th>{{ 'tr_email' | translate }}</th>
            <th>{{ 'tr_role' | translate }}</th>
            <th>{{ 'tr_branch' | translate }}</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of usersList; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.role }}</td>
            <td>{{ user.branch?.name }}</td>
            <td>
              <span class="options-menu">
                <i class="fa fa-ellipsis-v"></i>
                <div class="options-menu-container p-0">
                  <div class="single-option" (click)="createOrEditUser(true, user)">
                    {{ 'tr_action.edit' | translate }}
                  </div>
                  <div class="border-bottom"></div>
                  <div class="single-option" (click)="deleteUser(user._id)">
                    <div class="text-error">{{ 'tr_action.delete' | translate }}</div>
                  </div>
                </div>
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="empty-state-here text-center ptb-8" *ngIf="usersList.length === 0">
      <i class="fas fa-user-slash empty-icon"></i>
      <p>{{ 'tr_no_users_found' | translate }}</p>
    </div>

    <div class="plr-4 ptb-4">
      <pagination
        [paginationData]="paginationData"
        [perPage]="paginationPerPage"
        (paginationUpdate)="paginationUpdate($event)">
      </pagination>
    </div>
  </div>

  <div *ngIf="usersLoading">
    <app-ghost-line [length]="12" [type]="'table'"></app-ghost-line>
  </div>
</div>
